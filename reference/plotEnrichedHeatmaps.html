<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Plots enrichment heatmaps from the output of signal2Matrix 
(i.e. an EnrichmentSE object or a list of signal matrices). This is a 
convenience wrapper around EnrichedHeatmap."><title>plotEnrichedHeatmaps: Plots heatmaps of signals around a set of regions — plotEnrichedHeatmaps • epiwraps</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="plotEnrichedHeatmaps: Plots heatmaps of signals around a set of regions — plotEnrichedHeatmaps"><meta property="og:description" content="Plots enrichment heatmaps from the output of signal2Matrix 
(i.e. an EnrichmentSE object or a list of signal matrices). This is a 
convenience wrapper around EnrichedHeatmap."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">epiwraps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.84</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/bam2bw.html">Generating bigwig tracks with bam2bw</a>
    <a class="dropdown-item" href="../articles/misc.html">Miscellaneous epiwraps functions</a>
    <a class="dropdown-item" href="../articles/multiRegionPlot.html">Visualizing signals across many regions</a>
    <a class="dropdown-item" href="../articles/singleRegionPlot.html">Visualizing signals in a single region</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>plotEnrichedHeatmaps: Plots heatmaps of signals around a set of regions</h1>
      
      <div class="d-none name"><code>plotEnrichedHeatmaps.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots enrichment heatmaps from the output of <code><a href="signal2Matrix.html">signal2Matrix</a></code> 
(i.e. an EnrichmentSE object or a list of signal matrices). This is a 
convenience wrapper around <code><a href="https://rdrr.io/pkg/EnrichedHeatmap/man/EnrichedHeatmap.html" class="external-link">EnrichedHeatmap</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotEnrichedHeatmaps</span><span class="op">(</span></span>
<span>  <span class="va">ml</span>,</span>
<span>  trim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.98</span><span class="op">)</span>,</span>
<span>  assay <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  colors <span class="op">=</span> <span class="fu">inferno</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>  scale_title <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>  column_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  multiScale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_title_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span>
<span>  row_order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  row_split <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axis_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minRowVal <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  scale_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  top_annotation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  left_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  right_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mean_color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  mean_scale_side <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mean_trim <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_heatmap_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_raster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>ml</dt>
<dd><p>A named matrix list as produced by <code><a href="signal2Matrix.html">signal2Matrix</a></code>, or
an `EnrichmentSE` object.</p></dd>


<dt>trim</dt>
<dd><p>The quantile above which to trim values for the colorscale. If a
numeric vector of length 2, will be used as lower and upper quantiles 
beyond which to trim.</p></dd>


<dt>assay</dt>
<dd><p>Assay to use (ignored unless `ml` is an ESE object)</p></dd>


<dt>colors</dt>
<dd><p>The heatmap colors to use, a vector of at least two colors 
between which to interpolate. Can also be a list of such color scales, with
as many slots as there are tracks in `ml`.</p></dd>


<dt>scale_title</dt>
<dd><p>The title of the scale. Ignored if `multiScale=TRUE`.</p></dd>


<dt>multiScale</dt>
<dd><p>Logical; whether to use a different scale for each track.
Defaults to TRUE is `colors` is a list, otherwise FALSE.</p></dd>


<dt>column_title_gp</dt>
<dd><p>Graphic parameters of the column titles (see 
<code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></code>)</p></dd>


<dt>row_order</dt>
<dd><p>Optional order of the rows.</p></dd>


<dt>cluster_rows</dt>
<dd><p>Whether to cluster rows.</p></dd>


<dt>row_split</dt>
<dd><p>Splitting of rows.</p></dd>


<dt>axis_name</dt>
<dd><p>A vector of length 3 giving the labels to put respectively
on the left, center and right of the x axis of each heatmap.</p></dd>


<dt>minRowVal</dt>
<dd><p>Minimum value a row should have to be included</p></dd>


<dt>scale_rows</dt>
<dd><p>Whether to scale rows, either FALSE (default), 'local' 
(scales each matrix separately) or 'global'.</p></dd>


<dt>top_annotation</dt>
<dd><p>Either a logical indicating whether or not to plot the
summary profile at the top of each heatmap, a named list of parameters to be 
  passed to `anno_enrich`, or a 
  <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation-class.html" class="external-link">HeatmapAnnotation-class</a></code> object that will be 
  passed to <code><a href="https://rdrr.io/pkg/EnrichedHeatmap/man/EnrichedHeatmap.html" class="external-link">EnrichedHeatmap</a></code>. Additionally, if
  `ml` is a `ESE` object, `top_annotation` can be a vector of colData column
  names.</p></dd>


<dt>left_annotation</dt>
<dd><p>Passed to <code><a href="https://rdrr.io/pkg/EnrichedHeatmap/man/EnrichedHeatmap.html" class="external-link">EnrichedHeatmap</a></code></p></dd>


<dt>right_annotation</dt>
<dd><p>Passed to <code><a href="https://rdrr.io/pkg/EnrichedHeatmap/man/EnrichedHeatmap.html" class="external-link">EnrichedHeatmap</a></code></p></dd>


<dt>mean_color</dt>
<dd><p>Color of the mean signal line in the top annotation. If
`row_split` is used, `mean_color` can be a named vector indicating the 
colors for each cluster. Can also be a `gpar` object.</p></dd>


<dt>mean_scale_side</dt>
<dd><p>The side on which to show the y-axis scale of the mean
plots. Either "both" (default), "left", "right", or "none".</p></dd>


<dt>show_heatmap_legend</dt>
<dd><p>Logical, whether to show the heatmap legend</p></dd>


<dt>use_raster</dt>
<dd><p>Logical; whether to render the heatmap body as a raster 
image. Turned on by default if any of the matrix dimensions is greater than
2000.</p></dd>


<dt>...</dt>
<dd><p>Passed to <code><a href="https://rdrr.io/pkg/EnrichedHeatmap/man/EnrichedHeatmap.html" class="external-link">EnrichedHeatmap</a></code></p></dd>


<dt>Logical;</dt>
<dd><p>whether to apply the trimming also to the mean plot.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A HeatmapList object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When plotting large matrices, the heatmap body will be rasterized to keep its
memory footprint decent. Depending on your settings, if the heatmap is very
big you might hit the preset limits of `magick` base rasterization, which
could result in an error such as 'Image must have at least 1 frame to write a 
bitmap'. In such cases, you might have to degrade to a lower-quality 
rasterization using the additional arguments 
`raster_by_magick=FALSE, raster_device="CairoJPEG"` .</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># we first fetch the path to the example bigwig file:</span></span></span>
<span class="r-in"><span><span class="va">bw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_atac.bw"</span>, package<span class="op">=</span><span class="st">"epiwraps"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Since we only have one, we'll use the same and pretend they're 2 samples:</span></span></span>
<span class="r-in"><span><span class="va">bw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>sample1<span class="op">=</span><span class="va">bw</span>, sample2<span class="op">=</span><span class="va">bw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># we next load regions of interest (either GRanges or path to a bed file):</span></span></span>
<span class="r-in"><span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/example_peaks.bed"</span>, package<span class="op">=</span><span class="st">"epiwraps"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># we obtain the matrix of the signal around the regions:</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="signal2Matrix.html">signal2Matrix</a></span><span class="op">(</span><span class="va">bw</span>, <span class="va">regions</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading /home/runner/work/_temp/Library/epiwraps/extdata/example_atac.bw</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading /home/runner/work/_temp/Library/epiwraps/extdata/example_atac.bw</span>
<span class="r-in"><span><span class="fu">plotEnrichedHeatmaps</span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotEnrichedHeatmaps-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># we could also just plot one with:</span></span></span>
<span class="r-in"><span><span class="co"># plotEnrichedHeatmaps(m[,1])</span></span></span>
<span class="r-in"><span><span class="co"># or change the aesthetics, e.g.:</span></span></span>
<span class="r-in"><span><span class="fu">plotEnrichedHeatmaps</span><span class="op">(</span><span class="va">m</span>, trim<span class="op">=</span><span class="fl">0.98</span>, scale_title<span class="op">=</span><span class="st">"RPKM"</span>, </span></span>
<span class="r-in"><span>                     colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>,<span class="st">"darkred"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotEnrichedHeatmaps-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># any argument accepted by `EnrichedHeatmap` (and hence by </span></span></span>
<span class="r-in"><span><span class="co"># `ComplexHeatmap::Heatmap`) can be used, e.g.: </span></span></span>
<span class="r-in"><span><span class="fu">plotEnrichedHeatmaps</span><span class="op">(</span><span class="va">m</span>, row_title<span class="op">=</span><span class="st">"My regions of interest"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotEnrichedHeatmaps-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Pierre-Luc Germain, Emanuel Sonder.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer></div>

  

  

  </body></html>

